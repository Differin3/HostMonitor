# Nginx конфигурация для системы мониторинга
upstream php_backend {
    server unix:/var/run/php/php-fpm.sock; # PHP-FPM сокет (стандартный путь на Debian/Ubuntu)
}

server {
    listen 80; # HTTP-порт
    server_name _; # можно заменить на реальный домен

    root /var/www/monitoring; # корень PHP-приложения (каталог с index.php)
    index index.php; # главный файл

    # Веб-интерфейс (PHP)
    location / {
        try_files $uri $uri/ /index.php?$query_string; # ЧПУ-маршрутизация
    }

    # PHP обработка через PHP-FPM
    location ~ \.php$ {
        include snippets/fastcgi-php.conf; # стандартные fastcgi-настройки
        fastcgi_pass php_backend; # backend PHP-FPM
    }

    # Статические файлы frontend
    location /frontend/ {
        alias /var/www/monitoring/frontend/; # каталог фронтенда
        expires 30d; # кэширование
        add_header Cache-Control "public, immutable"; # заголовки кэша
    }

    # API endpoints обрабатываются PHP напрямую через location / выше
}

